<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title data-i18n="appPageTitle">Mueblecito - MDF Cut Plan Generator</title>
</head>
<body>
  <div id="app" class="app">
    <header class="app__header">
      <div class="app__header-content">
        <h1 data-i18n="appTitle">Mueblecito</h1>
        <p class="app__subtitle" data-i18n="appSubtitle">MDF Modular Cabinet Cut Plan Generator</p>
      </div>
      <div class="app__header-actions">
        <select id="language-switcher" class="language-switcher" data-i18n-aria-label="selectLanguage" aria-label="Select language">
          <option value="es" data-i18n="languageOptionEs">üá™üá∏ Espa√±ol</option>
          <option value="en" data-i18n="languageOptionEn">üá∫üá∏ English</option>
        </select>
        <a href="how-to-use.html" class="btn btn--howto" id="howto-link-en" aria-label="How to use Mueblecito (opens help page)">
          How to use
        </a>
        <a href="como-usar.html" class="btn btn--howto" id="howto-link-es" aria-label="C√≥mo usar Mueblecito (abre la ayuda)" style="display:none;">
          C√≥mo usar
        </a>
        <script>
        // Show the correct help link based on language
        (function() {
          var langSel = document.getElementById('language-switcher');
          var linkEn = document.getElementById('howto-link-en');
          var linkEs = document.getElementById('howto-link-es');
          function updateHelpLink() {
            if (langSel.value === 'es') {
              linkEn.style.display = 'none';
              linkEs.style.display = '';
            } else {
              linkEn.style.display = '';
              linkEs.style.display = 'none';
            }
          }
          langSel.addEventListener('change', updateHelpLink);
          updateHelpLink();
        })();
        </script>
      </div>
    </header>

    <main class="app__main">
      <!-- Project Selection -->
      <section class="section project-section">
        <div class="section__header">
          <h2 data-i18n="projects">Projects</h2>
          <button id="btn-new-project" class="btn btn--primary" data-i18n="newProject">+ New Project</button>
        </div>
        <div class="project-list" id="project-list">
          <!-- Projects will be rendered here -->
        </div>
      </section>

      <!-- Project Editor (hidden by default) -->
      <section class="section project-editor hidden" id="project-editor">
        <div class="section__header">
          <h2 id="project-title"></h2>
          <div class="btn-group">
            <button id="btn-edit-project" class="btn btn--secondary" data-i18n="editSettings">Edit Settings</button>
            <button id="btn-back-projects" class="btn btn--text" data-i18n="backToProjects">‚Üê Back to Projects</button>
          </div>
        </div>

        <!-- Project Settings Modal -->
        <div class="modal hidden" id="project-settings-modal">
          <div class="modal__content">
            <div class="modal__header">
              <h3 data-i18n="projectSettings">Project Settings</h3>
              <button class="btn btn--close" id="btn-close-project-settings" data-i18n-title="closeModal" data-i18n-aria-label="closeModal">&times;</button>
            </div>
            <form id="project-settings-form">
              <div class="form-group">
                <label for="project-name" data-i18n="projectName">Project Name</label>
                <input type="text" id="project-name" required>
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label for="default-countertop-thickness" data-i18n="defaultCountertopThickness">Default Countertop Thickness (mm)</label>
                  <input type="number" id="default-countertop-thickness" value="0" min="0" step="1">
                </div>
                <div class="form-group">
                  <label for="default-leg-height" data-i18n="defaultLegHeight">Default Leg Height (mm)</label>
                  <input type="number" id="default-leg-height" value="100" min="0" step="1">
                </div>
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label for="panel-discard-margin" data-i18n="panelDiscardMargin">Panel Discard Margin (mm)</label>
                  <input type="number" id="panel-discard-margin" value="15" min="0" step="1">
                </div>
                <div class="form-group">
                  <label for="kerf-width" data-i18n="kerfWidth">Kerf Width (mm)</label>
                  <input type="number" id="kerf-width" value="3" min="0" step="0.5">
                </div>
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label for="drawer-slide-clearance" data-i18n="drawerSlideClearance">Drawer Slide Clearance per side (mm)</label>
                  <input type="number" id="drawer-slide-clearance" value="25" min="0" step="1">
                </div>
              </div>
              
              <fieldset class="form-fieldset">
                <legend data-i18n="panelPrices">Panel Prices (per full panel)</legend>
                <div class="form-row">
                  <div class="form-group">
                    <label for="panel-price-18" data-i18n="thickness18mm">18 mm</label>
                    <input type="number" id="panel-price-18" value="0" min="0" step="0.01">
                  </div>
                  <div class="form-group">
                    <label for="panel-price-5.5" data-i18n="thickness55mm">5.5 mm</label>
                    <input type="number" id="panel-price-5.5" value="0" min="0" step="0.01">
                  </div>
                  <div class="form-group">
                    <label for="panel-price-3" data-i18n="thickness3mm">3 mm</label>
                    <input type="number" id="panel-price-3" value="0" min="0" step="0.01">
                  </div>
                </div>
              </fieldset>
              
              <div class="form-actions">
                <button type="submit" class="btn btn--primary" data-i18n="saveSettings">Save Settings</button>
              </div>
            </form>
          </div>
        </div>

        <!-- Modules List -->
        <div class="modules">
          <div class="modules__header">
            <h3 data-i18n="modules">Modules</h3>
            <button id="btn-add-module" class="btn btn--primary" data-i18n="addModule">+ Add Module</button>
          </div>
          <div class="modules__list" id="modules-list">
            <!-- Module items will be rendered here -->
          </div>
        </div>

        <!-- Module Form Modal -->
        <div class="modal hidden" id="module-modal">
          <div class="modal__content modal__content--large">
            <div class="modal__header">
              <h3 id="module-modal-title" data-i18n="addModule">Add Module</h3>
              <button class="btn btn--close" id="btn-close-module" data-i18n-title="closeModal" data-i18n-aria-label="closeModal">&times;</button>
            </div>
            <form id="module-form">
              <input type="hidden" id="module-id">
              
              <div class="form-row">
                <div class="form-group">
                  <label for="module-name" data-i18n="name">Name</label>
                  <input type="text" id="module-name" required>
                </div>
                <div class="form-group">
                  <label for="module-type" data-i18n="type">Type</label>
                  <select id="module-type" required>
                    <option value="lower" data-i18n="lowerCabinet">Lower Cabinet</option>
                    <option value="upper" data-i18n="upperCabinet">Upper Cabinet</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="module-quantity" data-i18n="quantity">Quantity</label>
                  <input type="number" id="module-quantity" value="1" min="1" step="1" required>
                </div>
              </div>

              <fieldset class="form-fieldset">
                <legend data-i18n="dimensions">Dimensions (mm)</legend>
                <div class="form-row">
                  <div class="form-group">
                    <label for="module-width" data-i18n="width">Width</label>
                    <input type="number" id="module-width" required min="1" step="1">
                  </div>
                  <div class="form-group">
                    <label for="module-depth" data-i18n="depth">Depth</label>
                    <input type="number" id="module-depth" required min="1" step="1">
                  </div>
                  <div class="form-group">
                    <label for="module-height" data-i18n="totalHeight">Total Height</label>
                    <input type="number" id="module-height" required min="1" step="1">
                  </div>
                </div>
              </fieldset>

              <fieldset class="form-fieldset lower-cabinet-options">
                <legend data-i18n="lowerCabinetOptions">Lower Cabinet Options</legend>
                <div class="form-row">
                  <div class="form-group">
                    <label for="module-leg-height" data-i18n="legHeight">Leg Height (mm)</label>
                    <input type="number" id="module-leg-height" value="100" min="0" step="1">
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label>
                      <input type="checkbox" id="module-has-countertop" checked>
                      <span data-i18n="hasCountertop">Has Countertop</span>
                    </label>
                  </div>
                </div>
                <div class="countertop-options" id="countertop-options">
                  <div class="form-row">
                    <div class="form-group">
                      <label for="module-countertop-thickness" data-i18n="countertopThickness">Countertop Thickness (mm)</label>
                      <input type="number" id="module-countertop-thickness" value="0" min="0" step="1">
                    </div>
                  </div>
                </div>
              </fieldset>

              <fieldset class="form-fieldset">
                <legend data-i18n="panelThicknesses">Panel Thicknesses (mm)</legend>
                <div class="form-row">
                  <div class="form-group">
                    <label for="module-structural-thickness" data-i18n="structuralPanels">Structural Panels</label>
                    <select id="module-structural-thickness">
                      <option value="18" selected data-i18n="thickness18mm">18 mm</option>
                      <option value="5.5" data-i18n="thickness55mm">5.5 mm</option>
                      <option value="3" data-i18n="thickness3mm">3 mm</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="module-back-thickness" data-i18n="backPanel">Back Panel</label>
                    <select id="module-back-thickness">
                      <option value="3" selected data-i18n="thickness3mm">3 mm</option>
                      <option value="5.5" data-i18n="thickness55mm">5.5 mm</option>
                      <option value="18" data-i18n="thickness18mm">18 mm</option>
                    </select>
                  </div>
                </div>
              </fieldset>

              <fieldset class="form-fieldset">
                <legend data-i18n="backPanel">Back Panel</legend>
                <div class="form-row">
                  <div class="form-group">
                    <label>
                      <input type="checkbox" id="module-has-back-panel" checked>
                      <span data-i18n="hasBackPanel">Has Back Panel</span>
                    </label>
                  </div>
                </div>
                <div id="back-panel-options">
                  <div class="form-row">
                    <div class="form-group">
                      <label for="module-back-type" data-i18n="backPanelPlacement">Back Panel Placement</label>
                      <select id="module-back-type">
                        <option value="inset" selected data-i18n="inset">Inset (inside the box)</option>
                        <option value="external" data-i18n="external">External (mounted on back)</option>
                      </select>
                    </div>
                  </div>
                </div>
              </fieldset>

              <fieldset class="form-fieldset">
                <legend data-i18n="boxConfiguration">Box Configuration</legend>
                <div class="form-row">
                  <div class="form-group">
                    <label>
                      <input type="checkbox" id="module-has-top" checked>
                      <span data-i18n="hasTopPanel">Has Top Panel</span>
                    </label>
                  </div>
                </div>
              </fieldset>

              <fieldset class="form-fieldset">
                <legend data-i18n="stretchers">Stretchers</legend>
                <div class="form-row">
                  <div class="form-group">
                    <label>
                      <input type="checkbox" id="module-has-top-stretcher">
                      <span data-i18n="topStretcher">Top Stretcher</span>
                    </label>
                  </div>
                  <div class="form-group">
                    <label>
                      <input type="checkbox" id="module-has-bottom-stretcher">
                      <span data-i18n="bottomStretcher">Bottom Stretcher</span>
                    </label>
                  </div>
                </div>
                <div class="stretcher-options hidden" id="stretcher-options">
                  <div class="form-row">
                    <div class="form-group">
                      <label for="module-stretcher-height" data-i18n="height">Height (mm)</label>
                      <input type="number" id="module-stretcher-height" value="80" min="20" step="1">
                    </div>
                  </div>
                </div>
              </fieldset>

              <fieldset class="form-fieldset">
                <legend data-i18n="doors">Doors</legend>
                <div class="form-row">
                  <div class="form-group">
                    <label>
                      <input type="checkbox" id="module-has-doors">
                      <span data-i18n="hasDoors">Has Doors</span>
                    </label>
                  </div>
                </div>
                <div class="door-options hidden" id="door-options">
                  <div class="form-row">
                    <div class="form-group">
                      <label for="module-door-type" data-i18n="doorType">Door Mounting</label>
                      <select id="module-door-type">
                        <option value="overlay" data-i18n="doorTypeOverlay">Overlay (over frame)</option>
                        <option value="inset" data-i18n="doorTypeInset">Inset (inside frame)</option>
                      </select>
                    </div>
                    <div class="form-group">
                      <label for="module-door-style" data-i18n="doorStyle">Door Style</label>
                      <select id="module-door-style">
                        <option value="flat" data-i18n="doorStyleFlat">Flat (slab)</option>
                        <option value="shaker" data-i18n="doorStyleShaker">Shaker (frame + panel)</option>
                      </select>
                    </div>
                    <div class="form-group">
                      <label for="module-door-gap" data-i18n="doorGap">Door Gap (mm)</label>
                      <input type="number" id="module-door-gap" value="2" min="0" step="0.5">
                    </div>
                  </div>
                  <div class="shaker-options hidden" id="shaker-options">
                    <div class="form-row">
                      <div class="form-group">
                        <label for="module-shaker-rail-width" data-i18n="shakerRailWidth">Rail Width (mm)</label>
                        <input type="number" id="module-shaker-rail-width" value="60" min="20" step="1">
                      </div>
                      <div class="form-group">
                        <label for="module-shaker-stile-width" data-i18n="shakerStileWidth">Stile Width (mm)</label>
                        <input type="number" id="module-shaker-stile-width" value="60" min="20" step="1">
                      </div>
                      <div class="form-group">
                        <label for="module-shaker-panel-thickness" data-i18n="shakerPanelThickness">Center Panel</label>
                        <select id="module-shaker-panel-thickness">
                          <option value="5.5" selected>5.5 mm</option>
                          <option value="3">3 mm</option>
                        </select>
                      </div>
                    </div>
                  </div>
                  <div class="door-list-header">
                    <span data-i18n="indexLabel">No.</span>
                    <span data-i18n="width">Width (mm)</span>
                    <span data-i18n="height">Height (mm)</span>
                    <span></span>
                  </div>
                  <div class="door-list" id="door-list"></div>
                  <button type="button" class="btn btn--secondary" id="btn-add-door" data-i18n="addDoor">+ Add Door</button>
                </div>
              </fieldset>

              <fieldset class="form-fieldset">
                <legend data-i18n="drawers">Drawers</legend>
                <div class="form-row">
                  <div class="form-group">
                    <label>
                      <input type="checkbox" id="module-has-drawers">
                      <span data-i18n="hasDrawers">Has Drawers</span>
                    </label>
                  </div>
                </div>
                <div class="drawer-options hidden" id="drawer-options">
                  <div class="form-row">
                    <div class="form-group">
                      <label for="module-drawer-front-type" data-i18n="drawerFrontType">Drawer Mounting</label>
                      <select id="module-drawer-front-type">
                        <option value="overlay" data-i18n="drawerFrontTypeOverlay">Overlay (over frame)</option>
                        <option value="inset" data-i18n="drawerFrontTypeInset">Inset (inside frame)</option>
                      </select>
                    </div>
                    <div class="form-group">
                      <label for="module-drawer-front-style" data-i18n="drawerFrontStyle">Drawer Front Style</label>
                      <select id="module-drawer-front-style">
                        <option value="flat" data-i18n="drawerFrontStyleFlat">Flat (slab)</option>
                        <option value="shaker" data-i18n="drawerFrontStyleShaker">Shaker (frame + panel)</option>
                      </select>
                    </div>
                  </div>
                  <div class="drawer-shaker-options hidden" id="drawer-shaker-options">
                    <div class="form-row">
                      <div class="form-group">
                        <label for="module-drawer-shaker-rail-width" data-i18n="drawerShakerRailWidth">Rail Width (mm)</label>
                        <input type="number" id="module-drawer-shaker-rail-width" value="60" min="20" step="1">
                      </div>
                      <div class="form-group">
                        <label for="module-drawer-shaker-stile-width" data-i18n="drawerShakerStileWidth">Stile Width (mm)</label>
                        <input type="number" id="module-drawer-shaker-stile-width" value="60" min="20" step="1">
                      </div>
                      <div class="form-group">
                        <label for="module-drawer-shaker-panel-thickness" data-i18n="drawerShakerPanelThickness">Center Panel</label>
                        <select id="module-drawer-shaker-panel-thickness">
                          <option value="5.5" selected>5.5 mm</option>
                          <option value="3">3 mm</option>
                        </select>
                      </div>
                    </div>
                  </div>
                  <div class="form-row">
                    <div class="form-group">
                      <label for="module-drawer-slide-clearance" data-i18n="slideClearance">Slide Clearance (mm)</label>
                      <input type="number" id="module-drawer-slide-clearance" value="25" min="0" step="1">
                    </div>
                    <div class="form-group">
                      <label for="module-drawer-bottom-thickness" data-i18n="drawerBottom">Drawer Bottom</label>
                      <select id="module-drawer-bottom-thickness">
                        <option value="3" selected data-i18n="thickness3mm">3 mm</option>
                        <option value="5.5" data-i18n="thickness55mm">5.5 mm</option>
                      </select>
                    </div>
                    <div class="form-group">
                      <label for="module-drawer-spacing" data-i18n="verticalSpacing">Vertical Spacing (mm)</label>
                      <input type="number" id="module-drawer-spacing" value="3" min="0" step="1">
                    </div>
                  </div>
                  <div class="drawer-list-header">
                    <span data-i18n="drawers">Drawers</span>
                    <span class="drawer-remaining-height" id="drawer-remaining-height"></span>
                    <button type="button" class="btn btn--secondary btn--small" id="btn-add-drawer" data-i18n="addDrawer">+ Add Drawer</button>
                  </div>
                  <div class="drawer-list" id="drawer-list">
                    <!-- Drawer items will be added here dynamically -->
                  </div>
                </div>
              </fieldset>

              <div class="form-actions">
                <button type="button" class="btn btn--text" id="btn-cancel-module" data-i18n="cancel">Cancel</button>
                <button type="submit" class="btn btn--primary" data-i18n="saveModule">Save Module</button>
              </div>
            </form>
            
            <!-- 3D Module Preview -->
            <div style="margin-top: 20px; padding: 20px;">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                <h4 data-i18n="3dPreview" style="margin: 0;">3D Preview</h4>
                <div style="display: flex; align-items: center; gap: 12px;">
                  <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; font-size: 0.9rem;">
                    <input type="checkbox" id="toggle-3d-fill" />
                    <span data-i18n="fillPanels">Fill panels</span>
                  </label>
                  <button type="button" id="btn-color-settings" class="btn btn--small btn--secondary" style="font-size: 0.8rem; padding: 4px 8px;" data-i18n="colorSettings">Colors</button>
                </div>
              </div>
              
              <!-- Color Settings Panel (hidden by default) -->
              <div id="color-settings-panel" class="hidden" style="background: #f5f5f5; padding: 12px; border-radius: 6px; margin-bottom: 10px;">
                <div class="color-settings-grid">
                  <div class="color-picker-group" data-component="cabinet">
                    <label data-i18n="cabinetColor">Cabinet</label>
                    <div class="color-picker-row">
                      <input type="color" id="color-cabinet" class="color-input" />
                      <span class="color-selected-name" id="color-cabinet-selected"></span>
                      <button type="button" class="btn btn--small btn--secondary color-browse-btn" data-component="cabinet" data-i18n="browsePalette">Browse</button>
                    </div>
                  </div>
                  <div class="color-picker-group" data-component="door">
                    <label data-i18n="doorColor">Doors</label>
                    <div class="color-picker-row">
                      <input type="color" id="color-door" class="color-input" />
                      <span class="color-selected-name" id="color-door-selected"></span>
                      <button type="button" class="btn btn--small btn--secondary color-browse-btn" data-component="door" data-i18n="browsePalette">Browse</button>
                    </div>
                  </div>
                  <div class="color-picker-group" data-component="drawer">
                    <label data-i18n="drawerColor">Drawers</label>
                    <div class="color-picker-row">
                      <input type="color" id="color-drawer" class="color-input" />
                      <span class="color-selected-name" id="color-drawer-selected"></span>
                      <button type="button" class="btn btn--small btn--secondary color-browse-btn" data-component="drawer" data-i18n="browsePalette">Browse</button>
                    </div>
                  </div>
                  <div class="color-picker-group" data-component="stretcher">
                    <label data-i18n="stretcherColor">Stretchers</label>
                    <div class="color-picker-row">
                      <input type="color" id="color-stretcher" class="color-input" />
                      <span class="color-selected-name" id="color-stretcher-selected"></span>
                      <button type="button" class="btn btn--small btn--secondary color-browse-btn" data-component="stretcher" data-i18n="browsePalette">Browse</button>
                    </div>
                  </div>
                  <div class="color-picker-group" data-component="leg">
                    <label data-i18n="legColor">Legs</label>
                    <div class="color-picker-row">
                      <input type="color" id="color-leg" class="color-input" />
                      <span class="color-selected-name" id="color-leg-selected"></span>
                      <button type="button" class="btn btn--small btn--secondary color-browse-btn" data-component="leg" data-i18n="browsePalette">Browse</button>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Color Palette Modal -->
              <div class="color-palette-modal hidden" id="color-palette-modal">
                <div class="color-palette-modal__backdrop"></div>
                <div class="color-palette-modal__content">
                  <div class="color-palette-modal__header">
                    <h4 data-i18n="colorPalette">Color Palette</h4>
                    <span class="color-palette-modal__for" id="color-palette-for"></span>
                    <button type="button" class="btn btn--text color-palette-modal__close" id="btn-close-palette">&times;</button>
                  </div>
                  <div class="color-palette-modal__search">
                    <input type="text" id="color-palette-search" class="color-palette-search-input" autocomplete="off" />
                    <span class="color-palette-modal__count" id="color-palette-count"></span>
                  </div>
                  <div class="color-palette-modal__body" id="color-palette-body">
                    <!-- Color swatches rendered here by JS -->
                  </div>
                </div>
              </div>
              
              <div id="module-3d" style="width: 100%; height: 75vh; border: 1px solid #ccc;"></div>
            </div>
          </div>
        </div>

        <!-- Results Section -->
        <div class="results-container">
          <div class="results-header">
            <h3 data-i18n="cutPlanResults">Cut Plan Results</h3>
            <button id="btn-generate" class="btn btn--success" data-i18n="generateCutPlan">Generate Cut Plan</button>
          </div>
          
          <div class="results-content hidden" id="results-content">
            <!-- Panel Summary -->
            <div class="panel-summary" id="panel-summary">
              <!-- Panel count will be rendered here -->
            </div>

            <!-- Panel Diagrams -->
            <div class="panel-diagrams-container">
              <h4 data-i18n="cuttingDiagram">Cutting Diagram</h4>
              <div class="panel-diagrams" id="panel-diagrams">
                <!-- Panel diagrams will be rendered here -->
              </div>
            </div>

            <!-- Parts Table -->
            <div class="parts-table-container">
              <div class="parts-table-header">
                <h4 data-i18n="partsList">Parts List</h4>
                <button class="btn btn--secondary" id="btn-export-csv" data-i18n="exportToCSV">Export to CSV</button>
              </div>
              <div class="parts-accordion" id="parts-accordion">
                <!-- Accordion panels will be rendered here -->
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer class="app__footer">
      <p data-i18n="copyright">&copy; 2026 Mueblecito - Workshop-Realistic MDF Cut Plans</p>
    </footer>
  </div>
</body>
</html>
